<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    x:Class="BookInventoryApp.BookPopupAndroid"
    Color="Black">

    <ScrollView VerticalScrollBarVisibility="Always">
        <VerticalStackLayout
            BackgroundColor="Black"
            Padding="25"
            Spacing="30"
            HorizontalOptions="Center"
            MaximumWidthRequest="630"
            WidthRequest="{OnIdiom Phone=350, Tablet=500, Desktop=630}"
            VerticalOptions="Center">

            <!-- Header -->
            <Label Text="Add Book"
                   FontSize="24"
                   FontAttributes="Bold"
                   FontFamily="VictorMono-Bold"
                   HorizontalOptions="Center"
                   TextColor="White"
                   Padding="10,6"
                   Margin="10" />


            <!-- Title -->
            <Entry x:Name="TitleEntry"
                   Placeholder="Book title"
                   TextColor="White"
                   PlaceholderColor="DarkGray"
                   BackgroundColor="DimGray"
                   FontFamily="VictorMono-LightItalic"
                   HeightRequest="45" 
                   WidthRequest="{OnIdiom Phone=300, Tablet=300}"
                   HorizontalOptions="StartAndExpand" />

            <HorizontalStackLayout  HorizontalOptions="StartAndExpand">
                <!-- Type -->
                <Picker x:Name="TypeEntry"
                    Title="Select book type..."
                    TextColor="White"
                    TitleColor="DarkGray"
                    FontFamily="VictorMono-LightItalic"
                    BackgroundColor="DimGray"
                    HeightRequest="60" 
                    HorizontalOptions="FillAndExpand"
                    WidthRequest="{OnIdiom Phone=140, Tablet=150}"
                    Margin="5,10,10,10"/>

                <!-- Status -->
                <Picker x:Name="StatusEntry"
                    Title="Select status..."
                    TextColor="White"
                    FontFamily="VictorMono-LightItalic"
                    BackgroundColor="DimGray"
                    TitleColor="DarkGray"
                    HeightRequest="60" 
                    HorizontalOptions="FillAndExpand"
                    WidthRequest="{OnIdiom Phone=140, Tablet=150, Desktop=250}"
                    Margin="5,10,10,10"/>

            </HorizontalStackLayout>

            <VerticalStackLayout>
                <!-- Authors -->
                <VerticalStackLayout  HorizontalOptions="Center">
                    <SearchBar x:Name="AuthorsSearch"
                               Placeholder="Search authors..."
                               TextChanged="OnSearchTextChanged"
                               BackgroundColor="DimGrey"
                               TextColor="White"
                               PlaceholderColor="LightGray"
                               FontFamily="VictorMono-Regular" 
                               HeightRequest="45" 
                               HorizontalOptions="FillAndExpand"
                               WidthRequest="{OnIdiom Phone=300, Tablet=300}"
                               Margin="10,10,10,10"/>

                    <AbsoluteLayout>
                        <AbsoluteLayout>
                            <SearchBar x:Name="LanguagesSearch"
                                       Placeholder="Search languages..."
                                       TextChanged="OnLanguagesSearchTextChanged"
                                       BackgroundColor="DimGray"
                                       TextColor="White"
                                       PlaceholderColor="LightGray"
                                       FontFamily="VictorMono-Regular"
                                       HeightRequest="45" 
                                       HorizontalOptions="FillAndExpand"
                                       WidthRequest="{OnIdiom Phone=300, Tablet=300}"
                                       Margin="0,10,10,10"/>

                            <ListView x:Name="FilteredAuthorsView"
                                      IsVisible="False"
                                      ItemSelected="Authors_ItemSelected"
                                      BackgroundColor="#DCD3FF"
                                      HeightRequest="100"
                                      SeparatorVisibility="None" 
                                      HorizontalOptions="FillAndExpand"
                                      WidthRequest="{OnIdiom Phone=300, Tablet=300}"
                                      Margin="0,10,10,10"/>
                        </AbsoluteLayout>


                    </AbsoluteLayout>

                </VerticalStackLayout>

                <VerticalStackLayout>
                    <SearchBar x:Name="CategoriesSearch"
                               Placeholder="Search categories..."
                               TextChanged="OnCategoriesSearchTextChanged"
                               BackgroundColor="DimGray"
                               TextColor="White"
                               PlaceholderColor="LightGray"
                               FontFamily="VictorMono-Regular"
                               HeightRequest="45" 
                               HorizontalOptions="FillAndExpand"
                               WidthRequest="{OnIdiom Phone=300, Tablet=300}"
                               Margin="10,10,10,10"/>
                    <AbsoluteLayout>

                        <ListView x:Name="FilteredCategoriesView"
                                  IsVisible="False"
                                  ItemSelected="Categories_ItemSelected"
                                  BackgroundColor="#DCD3FF"
                                  RowHeight="45"
                                  HeightRequest="100"
                                  SeparatorVisibility="None" 
                                  HorizontalOptions="FillAndExpand"
                                  WidthRequest="{OnIdiom Phone=300, Tablet=300}"
                                  Margin="5,10,10,10"/>
                    </AbsoluteLayout>
                </VerticalStackLayout>

            </VerticalStackLayout>



            <ListView x:Name="FilteredLanguagesView"
                      IsVisible="False"
                      ItemSelected="Languages_ItemSelected"
                      BackgroundColor="#DCD3FF"
                      RowHeight="50"
                      HeightRequest="100"
                      SeparatorVisibility="None" 
                      HorizontalOptions="Start"
                      WidthRequest="{OnIdiom Phone=50, Tablet=100, Desktop=250}"
                      Margin="0"/>



            <VerticalStackLayout>
                <HorizontalStackLayout HorizontalOptions="Center">
                    <VerticalStackLayout 
                              
                                         Padding="0"
                                         HorizontalOptions="FillAndExpand">
                        <Label x:Name="SelectedAuthorsViewName" 
                               Text="AUTHORS:" 
                               Margin="5,5,5,5" 
                               FontAttributes="Bold" 
                               HorizontalOptions="FillAndExpand"
                               BackgroundColor="#9370DB" Padding="10,10,10,10"></Label>
                        <CollectionView x:Name="SelectedAuthorsView"
                                        ItemsLayout="VerticalList"
                                        IsVisible="True"
                                        BackgroundColor="Transparent"
                                        MaximumWidthRequest="{OnIdiom Phone=50, Tablet=100, Desktop=150}"
                                        WidthRequest="{OnIdiom Phone=50, Tablet=100, Desktop=150}"
                                        Margin="5,5,5,5" />
                    </VerticalStackLayout>
                    <VerticalStackLayout 
                         
                                         Padding="0"
                                         HorizontalOptions="FillAndExpand"
>
                        <Label x:Name="SelectedCategoriesViewName" 
                               Text="CATEGORIES:" 
                               Margin="5,5,5,5" 
                               FontAttributes="Bold"
                               HorizontalOptions="FillAndExpand"
                                BackgroundColor="#9370DB"
                               Padding="10,10,10,10"></Label>
                        <CollectionView x:Name="SelectedCategoriesView"
                                        IsVisible="False"
                                        ItemsLayout="VerticalList"
                                        BackgroundColor="#9370DB"
                                        MaximumWidthRequest="{OnIdiom Phone=50, Tablet=100, Desktop=150}"
                                        WidthRequest="{OnIdiom Phone=50, Tablet=100, Desktop=150}"
                                        Margin="5,5,5,5"
                                        HorizontalOptions="FillAndExpand"/>
                    </VerticalStackLayout>

                    <VerticalStackLayout 
                               
                                         Padding="0"
                                         HorizontalOptions="FillAndExpand">
                        <Label x:Name="SelectedLanguagesViewName" 
                               Text="LANGUAGES:" 
                               Margin="5,5,5,5" 
                               FontAttributes="Bold"
                               HorizontalOptions="FillAndExpand"
                               BackgroundColor="#9370DB"
                               Padding="10,10,10,10"></Label>
                        <CollectionView x:Name="SelectedLanguagesView"
                                        IsVisible="False"
                                        ItemsLayout="VerticalList"
                                        BackgroundColor="#9370DB"
                                        MaximumWidthRequest="{OnIdiom Phone=50, Tablet=100, Desktop=150}"
                                        WidthRequest="{OnIdiom Phone=50, Tablet=100, Desktop=150}"
                                         Margin="5,5,5,5" 
                                        HorizontalOptions="FillAndExpand"/>
                    </VerticalStackLayout>

                </HorizontalStackLayout>
            </VerticalStackLayout>

            <!-- Save Button -->
            <Button Text="Save"
                    Clicked="OnSaveClicked"
                    TextColor="White"
                    BackgroundColor="MediumPurple"
                    FontAttributes="Bold"
                    CornerRadius="10"
                    FontFamily="VictorMono-Bold"
                    HorizontalOptions="Center"
                    WidthRequest="140"
                    Margin="10,20,10,10"
                    HeightRequest="45" />
            <Grid x:Name="SuccessOverlay"
                      BackgroundColor="#80000000"
                      IsVisible="False"
                      Opacity="0"
                      ZIndex="10"
                      HorizontalOptions="Fill"
                      VerticalOptions="Fill"
                      AbsoluteLayout.LayoutFlags="All"
                      AbsoluteLayout.LayoutBounds="0,0,1,1">
                <Label Text="✅ Book added successfully!"
                       FontSize="18"
                       FontAttributes="Bold"
                       TextColor="White"
                       BackgroundColor="MediumSeaGreen"
                       Padding="15"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"
                       Opacity="1"/>
            </Grid>

            <!-- Error Overlay -->
            <Grid x:Name="ErrorOverlay"
      BackgroundColor="#80000000"
      IsVisible="False"
      Opacity="0"
      ZIndex="10"
      HorizontalOptions="Fill"
      VerticalOptions="Fill"
      AbsoluteLayout.LayoutFlags="All"
      AbsoluteLayout.LayoutBounds="0,0,1,1">
                <Label Text="❌ Failed to add book!"
           FontSize="18"
           FontAttributes="Bold"
           TextColor="White"
           BackgroundColor="DarkRed"
           Padding="15"
           HorizontalOptions="Center"
           VerticalOptions="Center"
           Opacity="1"/>
            </Grid>
        </VerticalStackLayout>
        <!-- Success Overlay -->

    </ScrollView>
</toolkit:Popup>
