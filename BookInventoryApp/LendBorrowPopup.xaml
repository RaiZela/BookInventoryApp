<toolkit:Popup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
               xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
               xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
               x:Class="BookInventoryApp.LendBorrowPopup"
               Size="300,400">

    <Grid RowDefinitions="Auto,Auto,*,Auto,Auto"
          RowSpacing="15" x:Name="MainLayout">

        <!-- Title -->
        <Label x:Name="PopupTitle"
               Grid.Row="0"
               Text="Borrow / Lend Book"
               FontSize="20"
               HorizontalOptions="Center"
               FontAttributes="Bold"
               Margin="0,0,0,10" />

        <!-- SearchBar -->
        <SearchBar x:Name="BookSearchBar"
                   Grid.Row="1"
                   Placeholder="Search or enter book title"
                   TextChanged="OnBookSearchChanged"
                   BackgroundColor="#f2f2f2"
                   Margin="0" />

        <!-- Suggestions -->
        <CollectionView x:Name="BookSuggestions"
                        Grid.Row="2"
                        SelectionMode="Single"
                        IsVisible="False"
                        SelectionChanged="OnSuggestionSelected">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="5" BorderColor="#ccc" Margin="0,2">
                        <Label Text="{Binding Title}" />
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- DatePicker -->
        <DatePicker x:Name="BorrowDate"
                    Grid.Row="3"
                    Margin="0,10,0,0" />

        <!-- Save Button -->
        <Button x:Name="SaveButton"
                Grid.Row="4"
                Text="Save"
                Clicked="OnBorrowConfirm"
                BackgroundColor="MediumPurple"
                TextColor="White"
                CornerRadius="8"
                HorizontalOptions="Fill"
                Margin="0,10,0,0" />
        <!-- Success Overlay -->
        <Grid x:Name="SuccessOverlay"
         BackgroundColor="#80000000"
         IsVisible="False"
         Opacity="0"
         ZIndex="99"
         HorizontalOptions="Fill"
         VerticalOptions="Fill"
         RowSpan="3">

            <Label x:Name="SuccessIcon"
              Text="✅"
              FontSize="64"
              HorizontalOptions="Center"
              VerticalOptions="Center"/>
        </Grid>

        <!-- Error Overlay -->
        <Grid x:Name="ErrorOverlay"
         BackgroundColor="#80000000"
         IsVisible="False"
         Opacity="0"
         ZIndex="99"
         HorizontalOptions="Fill"
         VerticalOptions="Fill"
         RowSpan="3">

            <StackLayout VerticalOptions="Center"
                    HorizontalOptions="Center"
                    Spacing="10">
                <Label x:Name="ErrorIcon"
                  Text="❌"
                  FontSize="30"
                  TextColor="White"
                  HorizontalOptions="Center"/>
                <Label x:Name="ErrorMessage"
                  Text="Something went wrong!"
                  FontSize="18"
                  TextColor="White"
                  HorizontalOptions="Center"/>
            </StackLayout>
        </Grid>
    </Grid>
</toolkit:Popup>
